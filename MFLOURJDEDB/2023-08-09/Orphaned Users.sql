DECLARE @Lsid varbinary(85)
,@Usid varbinary(85)
USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'SY910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned1

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'SY910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [SY910] WITH PASSWORD = 'Pa$$w0rd', SID = 0xF1DE53A8F9575842AF206ABA09E2F0F9;
		PRINT N'LOGIN [SY910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [SY910] WITH LOGIN = [SY910];
			PRINT 'USER [SY910] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [SY910];
			PRINT N'USER [SY910] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned1:
	PRINT N'USER [SY910] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [SY910] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'OL910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned2

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'OL910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [OL910] WITH PASSWORD = 'Pa$$w0rd', SID = 0x8401883E6721224DAC9877FD1EB6C1C2;
		PRINT N'LOGIN [OL910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [OL910] WITH LOGIN = [OL910];
			PRINT 'USER [OL910] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [OL910];
			PRINT N'USER [OL910] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned2:
	PRINT N'USER [OL910] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [OL910] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PD910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned3

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PD910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PD910] WITH PASSWORD = 'Pa$$w0rd', SID = 0x6CD9DE6DAB4C34458ED48B3E4608F31D;
		PRINT N'LOGIN [PD910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PD910] WITH LOGIN = [PD910];
			PRINT 'USER [PD910] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [PD910];
			PRINT N'USER [PD910] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned3:
	PRINT N'USER [PD910] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PD910] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'DD910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned4

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'DD910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [DD910] WITH PASSWORD = 'Pa$$w0rd', SID = 0x7895671761F2FE4DAF4ABD139076A028;
		PRINT N'LOGIN [DD910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [DD910] WITH LOGIN = [DD910];
			PRINT 'USER [DD910] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [DD910];
			PRINT N'USER [DD910] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned4:
	PRINT N'USER [DD910] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [DD910] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS910DTA'

	IF @Usid IS NULL
		GOTO UserNotOrphaned5

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS910DTA'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS910DTA] WITH PASSWORD = 'Pa$$w0rd', SID = 0x97D89231EFC91C4E9FCEC10B2F173FE4;
		PRINT N'LOGIN [PS910DTA] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS910DTA] WITH LOGIN = [PS910DTA];
			PRINT 'USER [PS910DTA] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [PS910DTA];
			PRINT N'USER [PS910DTA] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned5:
	PRINT N'USER [PS910DTA] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS910DTA] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS910CTL'

	IF @Usid IS NULL
		GOTO UserNotOrphaned6

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS910CTL'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS910CTL] WITH PASSWORD = 'Pa$$w0rd', SID = 0xB5C8211A08FACA4591492DED12C92DBA;
		PRINT N'LOGIN [PS910CTL] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS910CTL] WITH LOGIN = [PS910CTL];
			PRINT 'USER [PS910CTL] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [PS910CTL];
			PRINT N'USER [PS910CTL] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned6:
	PRINT N'USER [PS910CTL] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS910CTL] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'JDEDBA'

	IF @Usid IS NULL
		GOTO UserNotOrphaned7

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'JDEDBA'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [JDEDBA] WITH PASSWORD = 'Pa$$w0rd', SID = 0x47DEBCA2A89B4B468634024F7DAEC7D6;
		PRINT N'LOGIN [JDEDBA] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [JDEDBA] WITH LOGIN = [JDEDBA];
			PRINT 'USER [JDEDBA] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [JDEDBA];
			PRINT N'USER [JDEDBA] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned7:
	PRINT N'USER [JDEDBA] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [JDEDBA] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'SVM910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned8

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'SVM910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [SVM910] WITH PASSWORD = 'Pa$$w0rd', SID = 0x9C6E4449EF7D5F489ABA6E6E16C03150;
		PRINT N'LOGIN [SVM910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [SVM910] WITH LOGIN = [SVM910];
			PRINT 'USER [SVM910] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [SVM910];
			PRINT N'USER [SVM910] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned8:
	PRINT N'USER [SVM910] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [SVM910] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PY910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned9

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PY910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PY910] WITH PASSWORD = 'Pa$$w0rd', SID = 0x63214C2EF17AEA41BB7C6C6D4FA18BC7;
		PRINT N'LOGIN [PY910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PY910] WITH LOGIN = [PY910];
			PRINT 'USER [PY910] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [PY910];
			PRINT N'USER [PY910] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned9:
	PRINT N'USER [PY910] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PY910] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'TESTDTA'

	IF @Usid IS NULL
		GOTO UserNotOrphaned10

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'TESTDTA'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [TESTDTA] WITH PASSWORD = 'Pa$$w0rd', SID = 0x86A92E9F9E31894EB36C70C73294EEDB;
		PRINT N'LOGIN [TESTDTA] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [TESTDTA] WITH LOGIN = [TESTDTA];
			PRINT 'USER [TESTDTA] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [TESTDTA];
			PRINT N'USER [TESTDTA] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned10:
	PRINT N'USER [TESTDTA] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [TESTDTA] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'TESTCTL'

	IF @Usid IS NULL
		GOTO UserNotOrphaned11

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'TESTCTL'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [TESTCTL] WITH PASSWORD = 'Pa$$w0rd', SID = 0x75B7B173CC840E47A2B7675A6340595F;
		PRINT N'LOGIN [TESTCTL] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [TESTCTL] WITH LOGIN = [TESTCTL];
			PRINT 'USER [TESTCTL] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [TESTCTL];
			PRINT N'USER [TESTCTL] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned11:
	PRINT N'USER [TESTCTL] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [TESTCTL] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned12

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS910] WITH PASSWORD = 'Pa$$w0rd', SID = 0x3756D236682BF44E8088504206675F28;
		PRINT N'LOGIN [PS910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS910] WITH LOGIN = [PS910];
			PRINT 'USER [PS910] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [PS910];
			PRINT N'USER [PS910] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned12:
	PRINT N'USER [PS910] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS910] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'APPLEAD'

	IF @Usid IS NULL
		GOTO UserNotOrphaned13

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'APPLEAD'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [APPLEAD] WITH PASSWORD = 'Pa$$w0rd', SID = 0xD192AA8354C50140863A3991D80B51EA;
		PRINT N'LOGIN [APPLEAD] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [APPLEAD] WITH LOGIN = [APPLEAD];
			PRINT 'USER [APPLEAD] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [APPLEAD];
			PRINT N'USER [APPLEAD] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned13:
	PRINT N'USER [APPLEAD] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [APPLEAD] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PRODUSER'

	IF @Usid IS NULL
		GOTO UserNotOrphaned14

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PRODUSER'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PRODUSER] WITH PASSWORD = 'Pa$$w0rd', SID = 0x44E348ECD5933644960A98E7E5979EFF;
		PRINT N'LOGIN [PRODUSER] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PRODUSER] WITH LOGIN = [PRODUSER];
			PRINT 'USER [PRODUSER] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [PRODUSER];
			PRINT N'USER [PRODUSER] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned14:
	PRINT N'USER [PRODUSER] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PRODUSER] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'DEVUSER'

	IF @Usid IS NULL
		GOTO UserNotOrphaned15

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'DEVUSER'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [DEVUSER] WITH PASSWORD = 'Pa$$w0rd', SID = 0xEDDEBCE762B9F14AA99055837AFD0841;
		PRINT N'LOGIN [DEVUSER] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [DEVUSER] WITH LOGIN = [DEVUSER];
			PRINT 'USER [DEVUSER] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [DEVUSER];
			PRINT N'USER [DEVUSER] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned15:
	PRINT N'USER [DEVUSER] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [DEVUSER] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'DV910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned16

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'DV910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [DV910] WITH PASSWORD = 'Pa$$w0rd', SID = 0xAA8CE437576F5649B5C75F2F64A2B5A5;
		PRINT N'LOGIN [DV910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [DV910] WITH LOGIN = [DV910];
			PRINT 'USER [DV910] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [DV910];
			PRINT N'USER [DV910] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned16:
	PRINT N'USER [DV910] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [DV910] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PSFT'

	IF @Usid IS NULL
		GOTO UserNotOrphaned17

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PSFT'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PSFT] WITH PASSWORD = 'Pa$$w0rd', SID = 0xCCB14D2F3C0B6048AC9E92A046EED82B;
		PRINT N'LOGIN [PSFT] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PSFT] WITH LOGIN = [PSFT];
			PRINT 'USER [PSFT] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [PSFT];
			PRINT N'USER [PSFT] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned17:
	PRINT N'USER [PSFT] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PSFT] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'SY811'

	IF @Usid IS NULL
		GOTO UserNotOrphaned18

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'SY811'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [SY811] WITH PASSWORD = 'Pa$$w0rd', SID = 0x5F53213FCC2E4B40835E64720EF2BCF7;
		PRINT N'LOGIN [SY811] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [SY811] WITH LOGIN = [SY811];
			PRINT 'USER [SY811] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [SY811];
			PRINT N'USER [SY811] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned18:
	PRINT N'USER [SY811] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [SY811] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS811'

	IF @Usid IS NULL
		GOTO UserNotOrphaned19

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS811'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS811] WITH PASSWORD = 'Pa$$w0rd', SID = 0xDFCB23AE77649C458D8E680D77499F92;
		PRINT N'LOGIN [PS811] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS811] WITH LOGIN = [PS811];
			PRINT 'USER [PS811] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [PS811];
			PRINT N'USER [PS811] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned19:
	PRINT N'USER [PS811] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS811] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'OL811'

	IF @Usid IS NULL
		GOTO UserNotOrphaned20

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'OL811'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [OL811] WITH PASSWORD = 'Pa$$w0rd', SID = 0x2A669BEC8134674BB990405D32550BF2;
		PRINT N'LOGIN [OL811] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [OL811] WITH LOGIN = [OL811];
			PRINT 'USER [OL811] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [OL811];
			PRINT N'USER [OL811] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned20:
	PRINT N'USER [OL811] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [OL811] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'DD811'

	IF @Usid IS NULL
		GOTO UserNotOrphaned21

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'DD811'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [DD811] WITH PASSWORD = 'Pa$$w0rd', SID = 0xD812CAE7B2CCC547AE305DF3613DE7BA;
		PRINT N'LOGIN [DD811] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [DD811] WITH LOGIN = [DD811];
			PRINT 'USER [DD811] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [DD811];
			PRINT N'USER [DD811] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned21:
	PRINT N'USER [DD811] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [DD811] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PY811'

	IF @Usid IS NULL
		GOTO UserNotOrphaned22

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PY811'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PY811] WITH PASSWORD = 'Pa$$w0rd', SID = 0x670956D47EB88943A1924FA2F739CFE9;
		PRINT N'LOGIN [PY811] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PY811] WITH LOGIN = [PY811];
			PRINT 'USER [PY811] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [PY811];
			PRINT N'USER [PY811] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned22:
	PRINT N'USER [PY811] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PY811] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'wdsuser'

	IF @Usid IS NULL
		GOTO UserNotOrphaned23

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'wdsuser'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [wdsuser] WITH PASSWORD = 'Pa$$w0rd', SID = 0xC6D5F9D24589414685B9CC465631883A;
		PRINT N'LOGIN [wdsuser] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [wdsuser] WITH LOGIN = [wdsuser];
			PRINT 'USER [wdsuser] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [wdsuser];
			PRINT N'USER [wdsuser] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned23:
	PRINT N'USER [wdsuser] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [wdsuser] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'maggie'

	IF @Usid IS NULL
		GOTO UserNotOrphaned24

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'maggie'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [maggie] WITH PASSWORD = 'Pa$$w0rd', SID = 0x529138F6369B2741B6127ECC64B1A4FF;
		PRINT N'LOGIN [maggie] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [maggie] WITH LOGIN = [maggie];
			PRINT 'USER [maggie] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [maggie];
			PRINT N'USER [maggie] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned24:
	PRINT N'USER [maggie] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [maggie] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PRODUCTION]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'anbarasan'

	IF @Usid IS NULL
		GOTO UserNotOrphaned25

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'anbarasan'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [anbarasan] WITH PASSWORD = 'Pa$$w0rd', SID = 0x017C854547108A45BA4229BE536C3BCA;
		PRINT N'LOGIN [anbarasan] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [anbarasan] WITH LOGIN = [anbarasan];
			PRINT 'USER [anbarasan] ON DATABASE [JDE_PRODUCTION] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PRODUCTION];
			DROP USER [anbarasan];
			PRINT N'USER [anbarasan] ON DATABASE [JDE_PRODUCTION] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned25:
	PRINT N'USER [anbarasan] ON DATABASE [JDE_PRODUCTION] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [anbarasan] ON DATABASE [JDE_PRODUCTION] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PD920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS920DTA'

	IF @Usid IS NULL
		GOTO UserNotOrphaned26

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS920DTA'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS920DTA] WITH PASSWORD = 'Pa$$w0rd', SID = 0x6CECC7FE99620E4786C88BBC58A0D281;
		PRINT N'LOGIN [PS920DTA] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS920DTA] WITH LOGIN = [PS920DTA];
			PRINT 'USER [PS920DTA] ON DATABASE [JDE_PD920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PD920];
			DROP USER [PS920DTA];
			PRINT N'USER [PS920DTA] ON DATABASE [JDE_PD920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned26:
	PRINT N'USER [PS920DTA] ON DATABASE [JDE_PD920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS920DTA] ON DATABASE [JDE_PD920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PD920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS920CTL'

	IF @Usid IS NULL
		GOTO UserNotOrphaned27

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS920CTL'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS920CTL] WITH PASSWORD = 'Pa$$w0rd', SID = 0x814F84CCE87FEC4A968D53AEF00A5DB6;
		PRINT N'LOGIN [PS920CTL] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS920CTL] WITH LOGIN = [PS920CTL];
			PRINT 'USER [PS920CTL] ON DATABASE [JDE_PD920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PD920];
			DROP USER [PS920CTL];
			PRINT N'USER [PS920CTL] ON DATABASE [JDE_PD920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned27:
	PRINT N'USER [PS920CTL] ON DATABASE [JDE_PD920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS920CTL] ON DATABASE [JDE_PD920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PD920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PY920'

	IF @Usid IS NULL
		GOTO UserNotOrphaned28

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PY920'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PY920] WITH PASSWORD = 'Pa$$w0rd', SID = 0x66A672AD9E87264B993FDC17EF07AB21;
		PRINT N'LOGIN [PY920] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PY920] WITH LOGIN = [PY920];
			PRINT 'USER [PY920] ON DATABASE [JDE_PD920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PD920];
			DROP USER [PY920];
			PRINT N'USER [PY920] ON DATABASE [JDE_PD920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned28:
	PRINT N'USER [PY920] ON DATABASE [JDE_PD920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PY920] ON DATABASE [JDE_PD920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PD920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'TESTDTA'

	IF @Usid IS NULL
		GOTO UserNotOrphaned29

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'TESTDTA'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [TESTDTA] WITH PASSWORD = 'Pa$$w0rd', SID = 0x34648694615A1F41B016291BFE74B92F;
		PRINT N'LOGIN [TESTDTA] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [TESTDTA] WITH LOGIN = [TESTDTA];
			PRINT 'USER [TESTDTA] ON DATABASE [JDE_PD920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PD920];
			DROP USER [TESTDTA];
			PRINT N'USER [TESTDTA] ON DATABASE [JDE_PD920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned29:
	PRINT N'USER [TESTDTA] ON DATABASE [JDE_PD920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [TESTDTA] ON DATABASE [JDE_PD920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PD920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'TESTCTL'

	IF @Usid IS NULL
		GOTO UserNotOrphaned30

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'TESTCTL'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [TESTCTL] WITH PASSWORD = 'Pa$$w0rd', SID = 0x14BF66708364CE44AEEADD77E8AD0F5D;
		PRINT N'LOGIN [TESTCTL] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [TESTCTL] WITH LOGIN = [TESTCTL];
			PRINT 'USER [TESTCTL] ON DATABASE [JDE_PD920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PD920];
			DROP USER [TESTCTL];
			PRINT N'USER [TESTCTL] ON DATABASE [JDE_PD920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned30:
	PRINT N'USER [TESTCTL] ON DATABASE [JDE_PD920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [TESTCTL] ON DATABASE [JDE_PD920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_PD920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS920'

	IF @Usid IS NULL
		GOTO UserNotOrphaned31

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS920'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS920] WITH PASSWORD = 'Pa$$w0rd', SID = 0xF254523CF336EF489D26AE3F652581F8;
		PRINT N'LOGIN [PS920] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS920] WITH LOGIN = [PS920];
			PRINT 'USER [PS920] ON DATABASE [JDE_PD920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_PD920];
			DROP USER [PS920];
			PRINT N'USER [PS920] ON DATABASE [JDE_PD920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned31:
	PRINT N'USER [PS920] ON DATABASE [JDE_PD920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS920] ON DATABASE [JDE_PD920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'SY910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned32

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'SY910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [SY910] WITH PASSWORD = 'Pa$$w0rd', SID = 0xF1DE53A8F9575842AF206ABA09E2F0F9;
		PRINT N'LOGIN [SY910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [SY910] WITH LOGIN = [SY910];
			PRINT 'USER [SY910] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [SY910];
			PRINT N'USER [SY910] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned32:
	PRINT N'USER [SY910] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [SY910] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'OL910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned33

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'OL910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [OL910] WITH PASSWORD = 'Pa$$w0rd', SID = 0x8401883E6721224DAC9877FD1EB6C1C2;
		PRINT N'LOGIN [OL910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [OL910] WITH LOGIN = [OL910];
			PRINT 'USER [OL910] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [OL910];
			PRINT N'USER [OL910] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned33:
	PRINT N'USER [OL910] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [OL910] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PD910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned34

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PD910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PD910] WITH PASSWORD = 'Pa$$w0rd', SID = 0x6CD9DE6DAB4C34458ED48B3E4608F31D;
		PRINT N'LOGIN [PD910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PD910] WITH LOGIN = [PD910];
			PRINT 'USER [PD910] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [PD910];
			PRINT N'USER [PD910] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned34:
	PRINT N'USER [PD910] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PD910] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'DD910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned35

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'DD910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [DD910] WITH PASSWORD = 'Pa$$w0rd', SID = 0x7895671761F2FE4DAF4ABD139076A028;
		PRINT N'LOGIN [DD910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [DD910] WITH LOGIN = [DD910];
			PRINT 'USER [DD910] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [DD910];
			PRINT N'USER [DD910] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned35:
	PRINT N'USER [DD910] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [DD910] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS910DTA'

	IF @Usid IS NULL
		GOTO UserNotOrphaned36

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS910DTA'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS910DTA] WITH PASSWORD = 'Pa$$w0rd', SID = 0x97D89231EFC91C4E9FCEC10B2F173FE4;
		PRINT N'LOGIN [PS910DTA] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS910DTA] WITH LOGIN = [PS910DTA];
			PRINT 'USER [PS910DTA] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [PS910DTA];
			PRINT N'USER [PS910DTA] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned36:
	PRINT N'USER [PS910DTA] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS910DTA] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS910CTL'

	IF @Usid IS NULL
		GOTO UserNotOrphaned37

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS910CTL'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS910CTL] WITH PASSWORD = 'Pa$$w0rd', SID = 0xB5C8211A08FACA4591492DED12C92DBA;
		PRINT N'LOGIN [PS910CTL] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS910CTL] WITH LOGIN = [PS910CTL];
			PRINT 'USER [PS910CTL] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [PS910CTL];
			PRINT N'USER [PS910CTL] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned37:
	PRINT N'USER [PS910CTL] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS910CTL] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'JDEDBA'

	IF @Usid IS NULL
		GOTO UserNotOrphaned38

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'JDEDBA'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [JDEDBA] WITH PASSWORD = 'Pa$$w0rd', SID = 0x47DEBCA2A89B4B468634024F7DAEC7D6;
		PRINT N'LOGIN [JDEDBA] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [JDEDBA] WITH LOGIN = [JDEDBA];
			PRINT 'USER [JDEDBA] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [JDEDBA];
			PRINT N'USER [JDEDBA] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned38:
	PRINT N'USER [JDEDBA] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [JDEDBA] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'SVM910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned39

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'SVM910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [SVM910] WITH PASSWORD = 'Pa$$w0rd', SID = 0x9C6E4449EF7D5F489ABA6E6E16C03150;
		PRINT N'LOGIN [SVM910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [SVM910] WITH LOGIN = [SVM910];
			PRINT 'USER [SVM910] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [SVM910];
			PRINT N'USER [SVM910] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned39:
	PRINT N'USER [SVM910] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [SVM910] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PY910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned40

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PY910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PY910] WITH PASSWORD = 'Pa$$w0rd', SID = 0x63214C2EF17AEA41BB7C6C6D4FA18BC7;
		PRINT N'LOGIN [PY910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PY910] WITH LOGIN = [PY910];
			PRINT 'USER [PY910] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [PY910];
			PRINT N'USER [PY910] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned40:
	PRINT N'USER [PY910] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PY910] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'TESTDTA'

	IF @Usid IS NULL
		GOTO UserNotOrphaned41

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'TESTDTA'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [TESTDTA] WITH PASSWORD = 'Pa$$w0rd', SID = 0x86A92E9F9E31894EB36C70C73294EEDB;
		PRINT N'LOGIN [TESTDTA] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [TESTDTA] WITH LOGIN = [TESTDTA];
			PRINT 'USER [TESTDTA] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [TESTDTA];
			PRINT N'USER [TESTDTA] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned41:
	PRINT N'USER [TESTDTA] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [TESTDTA] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'TESTCTL'

	IF @Usid IS NULL
		GOTO UserNotOrphaned42

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'TESTCTL'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [TESTCTL] WITH PASSWORD = 'Pa$$w0rd', SID = 0x75B7B173CC840E47A2B7675A6340595F;
		PRINT N'LOGIN [TESTCTL] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [TESTCTL] WITH LOGIN = [TESTCTL];
			PRINT 'USER [TESTCTL] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [TESTCTL];
			PRINT N'USER [TESTCTL] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned42:
	PRINT N'USER [TESTCTL] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [TESTCTL] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned43

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS910] WITH PASSWORD = 'Pa$$w0rd', SID = 0x3756D236682BF44E8088504206675F28;
		PRINT N'LOGIN [PS910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS910] WITH LOGIN = [PS910];
			PRINT 'USER [PS910] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [PS910];
			PRINT N'USER [PS910] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned43:
	PRINT N'USER [PS910] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS910] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'APPLEAD'

	IF @Usid IS NULL
		GOTO UserNotOrphaned44

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'APPLEAD'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [APPLEAD] WITH PASSWORD = 'Pa$$w0rd', SID = 0xD192AA8354C50140863A3991D80B51EA;
		PRINT N'LOGIN [APPLEAD] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [APPLEAD] WITH LOGIN = [APPLEAD];
			PRINT 'USER [APPLEAD] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [APPLEAD];
			PRINT N'USER [APPLEAD] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned44:
	PRINT N'USER [APPLEAD] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [APPLEAD] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PRODUSER'

	IF @Usid IS NULL
		GOTO UserNotOrphaned45

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PRODUSER'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PRODUSER] WITH PASSWORD = 'Pa$$w0rd', SID = 0x44E348ECD5933644960A98E7E5979EFF;
		PRINT N'LOGIN [PRODUSER] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PRODUSER] WITH LOGIN = [PRODUSER];
			PRINT 'USER [PRODUSER] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [PRODUSER];
			PRINT N'USER [PRODUSER] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned45:
	PRINT N'USER [PRODUSER] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PRODUSER] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'DEVUSER'

	IF @Usid IS NULL
		GOTO UserNotOrphaned46

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'DEVUSER'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [DEVUSER] WITH PASSWORD = 'Pa$$w0rd', SID = 0xEDDEBCE762B9F14AA99055837AFD0841;
		PRINT N'LOGIN [DEVUSER] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [DEVUSER] WITH LOGIN = [DEVUSER];
			PRINT 'USER [DEVUSER] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [DEVUSER];
			PRINT N'USER [DEVUSER] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned46:
	PRINT N'USER [DEVUSER] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [DEVUSER] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'DV910'

	IF @Usid IS NULL
		GOTO UserNotOrphaned47

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'DV910'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [DV910] WITH PASSWORD = 'Pa$$w0rd', SID = 0xAA8CE437576F5649B5C75F2F64A2B5A5;
		PRINT N'LOGIN [DV910] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [DV910] WITH LOGIN = [DV910];
			PRINT 'USER [DV910] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [DV910];
			PRINT N'USER [DV910] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned47:
	PRINT N'USER [DV910] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [DV910] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PSFT'

	IF @Usid IS NULL
		GOTO UserNotOrphaned48

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PSFT'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PSFT] WITH PASSWORD = 'Pa$$w0rd', SID = 0xCCB14D2F3C0B6048AC9E92A046EED82B;
		PRINT N'LOGIN [PSFT] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PSFT] WITH LOGIN = [PSFT];
			PRINT 'USER [PSFT] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [PSFT];
			PRINT N'USER [PSFT] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned48:
	PRINT N'USER [PSFT] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PSFT] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'SY811'

	IF @Usid IS NULL
		GOTO UserNotOrphaned49

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'SY811'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [SY811] WITH PASSWORD = 'Pa$$w0rd', SID = 0x5F53213FCC2E4B40835E64720EF2BCF7;
		PRINT N'LOGIN [SY811] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [SY811] WITH LOGIN = [SY811];
			PRINT 'USER [SY811] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [SY811];
			PRINT N'USER [SY811] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned49:
	PRINT N'USER [SY811] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [SY811] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS811'

	IF @Usid IS NULL
		GOTO UserNotOrphaned50

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS811'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS811] WITH PASSWORD = 'Pa$$w0rd', SID = 0xDFCB23AE77649C458D8E680D77499F92;
		PRINT N'LOGIN [PS811] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS811] WITH LOGIN = [PS811];
			PRINT 'USER [PS811] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [PS811];
			PRINT N'USER [PS811] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned50:
	PRINT N'USER [PS811] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS811] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'OL811'

	IF @Usid IS NULL
		GOTO UserNotOrphaned51

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'OL811'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [OL811] WITH PASSWORD = 'Pa$$w0rd', SID = 0x2A669BEC8134674BB990405D32550BF2;
		PRINT N'LOGIN [OL811] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [OL811] WITH LOGIN = [OL811];
			PRINT 'USER [OL811] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [OL811];
			PRINT N'USER [OL811] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned51:
	PRINT N'USER [OL811] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [OL811] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'DD811'

	IF @Usid IS NULL
		GOTO UserNotOrphaned52

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'DD811'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [DD811] WITH PASSWORD = 'Pa$$w0rd', SID = 0xD812CAE7B2CCC547AE305DF3613DE7BA;
		PRINT N'LOGIN [DD811] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [DD811] WITH LOGIN = [DD811];
			PRINT 'USER [DD811] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [DD811];
			PRINT N'USER [DD811] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned52:
	PRINT N'USER [DD811] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [DD811] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE_ARCHIVE]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PY811'

	IF @Usid IS NULL
		GOTO UserNotOrphaned53

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PY811'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PY811] WITH PASSWORD = 'Pa$$w0rd', SID = 0x670956D47EB88943A1924FA2F739CFE9;
		PRINT N'LOGIN [PY811] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PY811] WITH LOGIN = [PY811];
			PRINT 'USER [PY811] ON DATABASE [JDE_ARCHIVE] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE_ARCHIVE];
			DROP USER [PY811];
			PRINT N'USER [PY811] ON DATABASE [JDE_ARCHIVE] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned53:
	PRINT N'USER [PY811] ON DATABASE [JDE_ARCHIVE] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PY811] ON DATABASE [JDE_ARCHIVE] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'JDE'

	IF @Usid IS NULL
		GOTO UserNotOrphaned54

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'JDE'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [JDE] WITH PASSWORD = 'Pa$$w0rd', SID = 0x573B6AAC349FB34F95CA767B46AF88AC;
		PRINT N'LOGIN [JDE] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [JDE] WITH LOGIN = [JDE];
			PRINT 'USER [JDE] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [JDE];
			PRINT N'USER [JDE] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned54:
	PRINT N'USER [JDE] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [JDE] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'SY920'

	IF @Usid IS NULL
		GOTO UserNotOrphaned55

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'SY920'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [SY920] WITH PASSWORD = 'Pa$$w0rd', SID = 0x366C2A0ED3897743B4BDE2AF9268881D;
		PRINT N'LOGIN [SY920] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [SY920] WITH LOGIN = [SY920];
			PRINT 'USER [SY920] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [SY920];
			PRINT N'USER [SY920] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned55:
	PRINT N'USER [SY920] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [SY920] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'OL920'

	IF @Usid IS NULL
		GOTO UserNotOrphaned56

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'OL920'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [OL920] WITH PASSWORD = 'Pa$$w0rd', SID = 0x098668102CC2F748A595D14AC8A80833;
		PRINT N'LOGIN [OL920] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [OL920] WITH LOGIN = [OL920];
			PRINT 'USER [OL920] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [OL920];
			PRINT N'USER [OL920] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned56:
	PRINT N'USER [OL920] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [OL920] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PD920'

	IF @Usid IS NULL
		GOTO UserNotOrphaned57

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PD920'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PD920] WITH PASSWORD = 'Pa$$w0rd', SID = 0xA11DB4AC274F824F9996BC52BF36CC52;
		PRINT N'LOGIN [PD920] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PD920] WITH LOGIN = [PD920];
			PRINT 'USER [PD920] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [PD920];
			PRINT N'USER [PD920] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned57:
	PRINT N'USER [PD920] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PD920] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'DD920'

	IF @Usid IS NULL
		GOTO UserNotOrphaned58

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'DD920'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [DD920] WITH PASSWORD = 'Pa$$w0rd', SID = 0x3A589DC94449214FBD4059B46EFB4E59;
		PRINT N'LOGIN [DD920] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [DD920] WITH LOGIN = [DD920];
			PRINT 'USER [DD920] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [DD920];
			PRINT N'USER [DD920] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned58:
	PRINT N'USER [DD920] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [DD920] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PRODDTA'

	IF @Usid IS NULL
		GOTO UserNotOrphaned59

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PRODDTA'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PRODDTA] WITH PASSWORD = 'Pa$$w0rd', SID = 0xE1CB2EB95D26434BAFAA96CE476714BD;
		PRINT N'LOGIN [PRODDTA] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PRODDTA] WITH LOGIN = [PRODDTA];
			PRINT 'USER [PRODDTA] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [PRODDTA];
			PRINT N'USER [PRODDTA] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned59:
	PRINT N'USER [PRODDTA] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PRODDTA] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS920DTA'

	IF @Usid IS NULL
		GOTO UserNotOrphaned60

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS920DTA'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS920DTA] WITH PASSWORD = 'Pa$$w0rd', SID = 0x6CECC7FE99620E4786C88BBC58A0D281;
		PRINT N'LOGIN [PS920DTA] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS920DTA] WITH LOGIN = [PS920DTA];
			PRINT 'USER [PS920DTA] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [PS920DTA];
			PRINT N'USER [PS920DTA] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned60:
	PRINT N'USER [PS920DTA] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS920DTA] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS920CTL'

	IF @Usid IS NULL
		GOTO UserNotOrphaned61

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS920CTL'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS920CTL] WITH PASSWORD = 'Pa$$w0rd', SID = 0x814F84CCE87FEC4A968D53AEF00A5DB6;
		PRINT N'LOGIN [PS920CTL] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS920CTL] WITH LOGIN = [PS920CTL];
			PRINT 'USER [PS920CTL] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [PS920CTL];
			PRINT N'USER [PS920CTL] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned61:
	PRINT N'USER [PS920CTL] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS920CTL] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PRODCTL'

	IF @Usid IS NULL
		GOTO UserNotOrphaned62

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PRODCTL'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PRODCTL] WITH PASSWORD = 'Pa$$w0rd', SID = 0x742AACC79A98D848B6A6AFBFE25FB002;
		PRINT N'LOGIN [PRODCTL] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PRODCTL] WITH LOGIN = [PRODCTL];
			PRINT 'USER [PRODCTL] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [PRODCTL];
			PRINT N'USER [PRODCTL] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned62:
	PRINT N'USER [PRODCTL] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PRODCTL] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'SVM920'

	IF @Usid IS NULL
		GOTO UserNotOrphaned63

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'SVM920'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [SVM920] WITH PASSWORD = 'Pa$$w0rd', SID = 0x181DB1D938CD8B43BAA1D71E5FAAAAA6;
		PRINT N'LOGIN [SVM920] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [SVM920] WITH LOGIN = [SVM920];
			PRINT 'USER [SVM920] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [SVM920];
			PRINT N'USER [SVM920] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned63:
	PRINT N'USER [SVM920] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [SVM920] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PY920'

	IF @Usid IS NULL
		GOTO UserNotOrphaned64

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PY920'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PY920] WITH PASSWORD = 'Pa$$w0rd', SID = 0x66A672AD9E87264B993FDC17EF07AB21;
		PRINT N'LOGIN [PY920] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PY920] WITH LOGIN = [PY920];
			PRINT 'USER [PY920] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [PY920];
			PRINT N'USER [PY920] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned64:
	PRINT N'USER [PY920] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PY920] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'CRPCTL'

	IF @Usid IS NULL
		GOTO UserNotOrphaned65

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'CRPCTL'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [CRPCTL] WITH PASSWORD = 'Pa$$w0rd', SID = 0x19F84F3DF20F204ABF984A9E2295BBB0;
		PRINT N'LOGIN [CRPCTL] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [CRPCTL] WITH LOGIN = [CRPCTL];
			PRINT 'USER [CRPCTL] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [CRPCTL];
			PRINT N'USER [CRPCTL] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned65:
	PRINT N'USER [CRPCTL] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [CRPCTL] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'CRPDTA'

	IF @Usid IS NULL
		GOTO UserNotOrphaned66

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'CRPDTA'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [CRPDTA] WITH PASSWORD = 'Pa$$w0rd', SID = 0xCAB85678A2F9B84D93A9A9A2E90CE4CE;
		PRINT N'LOGIN [CRPDTA] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [CRPDTA] WITH LOGIN = [CRPDTA];
			PRINT 'USER [CRPDTA] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [CRPDTA];
			PRINT N'USER [CRPDTA] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned66:
	PRINT N'USER [CRPDTA] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [CRPDTA] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'TESTDTA'

	IF @Usid IS NULL
		GOTO UserNotOrphaned67

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'TESTDTA'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [TESTDTA] WITH PASSWORD = 'Pa$$w0rd', SID = 0x34648694615A1F41B016291BFE74B92F;
		PRINT N'LOGIN [TESTDTA] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [TESTDTA] WITH LOGIN = [TESTDTA];
			PRINT 'USER [TESTDTA] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [TESTDTA];
			PRINT N'USER [TESTDTA] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned67:
	PRINT N'USER [TESTDTA] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [TESTDTA] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'TESTCTL'

	IF @Usid IS NULL
		GOTO UserNotOrphaned68

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'TESTCTL'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [TESTCTL] WITH PASSWORD = 'Pa$$w0rd', SID = 0x14BF66708364CE44AEEADD77E8AD0F5D;
		PRINT N'LOGIN [TESTCTL] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [TESTCTL] WITH LOGIN = [TESTCTL];
			PRINT 'USER [TESTCTL] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [TESTCTL];
			PRINT N'USER [TESTCTL] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned68:
	PRINT N'USER [TESTCTL] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [TESTCTL] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'PS920'

	IF @Usid IS NULL
		GOTO UserNotOrphaned69

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'PS920'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [PS920] WITH PASSWORD = 'Pa$$w0rd', SID = 0xF254523CF336EF489D26AE3F652581F8;
		PRINT N'LOGIN [PS920] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [PS920] WITH LOGIN = [PS920];
			PRINT 'USER [PS920] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [PS920];
			PRINT N'USER [PS920] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned69:
	PRINT N'USER [PS920] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [PS920] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'DV920'

	IF @Usid IS NULL
		GOTO UserNotOrphaned70

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'DV920'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [DV920] WITH PASSWORD = 'Pa$$w0rd', SID = 0xAF6455F24331124991614CB245A59B48;
		PRINT N'LOGIN [DV920] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [DV920] WITH LOGIN = [DV920];
			PRINT 'USER [DV920] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [DV920];
			PRINT N'USER [DV920] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned70:
	PRINT N'USER [DV920] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [DV920] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'JDE1'

	IF @Usid IS NULL
		GOTO UserNotOrphaned71

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'JDE1'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [JDE1] WITH PASSWORD = 'Pa$$w0rd', SID = 0x057BCBE7B736ED4099B832298CA03248;
		PRINT N'LOGIN [JDE1] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [JDE1] WITH LOGIN = [JDE1];
			PRINT 'USER [JDE1] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [JDE1];
			PRINT N'USER [JDE1] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned71:
	PRINT N'USER [JDE1] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [JDE1] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;

USE [JDE920]
BEGIN TRY
	SELECT @Usid = NULL 

SELECT @Usid = dp.sid
FROM sys.database_principals dp
LEFT JOIN sys.server_principals sp
ON dp.sid = sp.sid
LEFT JOIN sys.certificates c
ON dp.sid = c.sid
LEFT JOIN sys.asymmetric_keys a
ON dp.sid = a.sid
WHERE sp.sid IS NULL AND c.sid IS NULL AND a.sid IS NULL
AND dp.type IN ('U', 'S', 'C', 'K') 
AND dp.principal_id > 4
AND NOT (dp.type = 'S' AND LEN(dp.sid) = 28)
AND dp.name = 'anbarasan'

	IF @Usid IS NULL
		GOTO UserNotOrphaned72

	SELECT @Lsid = NULL
	SELECT @Lsid = sid FROM sys.server_principals WHERE name = 'anbarasan'
	IF @Lsid IS NULL
	BEGIN
		CREATE LOGIN [anbarasan] WITH PASSWORD = 'Pa$$w0rd', SID = 0xB110F2056DF72D4DB87C6E3A22971380;
		PRINT N'LOGIN [anbarasan] IS CREATED AND MAPPED TO CORRESPONDING USER.';
	END
	ELSE 
	BEGIN
		IF NOT EXISTS
		(SELECT * FROM sys.database_principals WHERE sid = @Lsid)
		BEGIN
			ALTER USER [anbarasan] WITH LOGIN = [anbarasan];
			PRINT 'USER [anbarasan] ON DATABASE [JDE920] IS MAPPED TO CORRESPONDING LOGIN.';
		END
		ELSE
		BEGIN
			USE [JDE920];
			DROP USER [anbarasan];
			PRINT N'USER [anbarasan] ON DATABASE [JDE920] IS DROPED. ANOTHER USER IS MAPPED TO THE CORRESPONDING LOGIN.';
		END
	END
UserNotOrphaned72:
	PRINT N'USER [anbarasan] ON DATABASE [JDE920] IS NOT ORPHANED.';
END TRY
BEGIN CATCH
	PRINT N'USER [anbarasan] ON DATABASE [JDE920] IS ORPHANED AND CANNOT BE DROPED OR MAPPED.';
END CATCH;
